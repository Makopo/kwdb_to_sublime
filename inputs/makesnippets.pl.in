use Text::Template;

<<< COMMON >>>

# for constants
my $template = Text::Template->new(SOURCE => 'templates/completions-constants.tmpl')
	or die "Couldn't construct template: $Text::Template::ERROR";
<<< CONSTANTS >>>

# for functions
my $template = Text::Template->new(SOURCE => 'templates/completions-functions.tmpl')
	or die "Couldn't construct template: $Text::Template::ERROR";
<<< FUNCTIONS >>>

# for events
my $template = Text::Template->new(SOURCE => 'templates/completions-events.tmpl')
	or die "Couldn't construct template: $Text::Template::ERROR";
<<< EVENTS >>>

sub print_snippet {
	my ($template, $cat, $version, $name, $content, $value) = @_;
	my %vars = (version => $version, name => $name, content => $content, value => $value);
	open (FILEHANDLE, ">" . $ENV{'OUTPUT_DIR'} . "/snippets/" . $cat . "/" . $name . ".sublime-snippet")
		or die "Can't open file: $!";
	$template->fill_in(HASH => \%vars, DELIMITERS => [ '[@--', '--@]' ], OUTPUT => \*FILEHANDLE)
 		or die "Couldn't fill in template: $Text::Template::ERROR" unless defined $result;
 	close (FILEHANDLE); 
}
